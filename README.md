# PowersOfAttorney

Данный пример содержит методы работы с демонстрационной пользовательской карточкой доверенности.

## Сокращения

СКД - системная карточка доверенности
ПКД - пользовательская карточки доверенности
МЧД - машиночитаемая доверенность

## Описание примера

Пример включает два компонента:

- PowersOfAttorneyServerExtension – папка с серверным расширением Web-клиента, в котором реализованы функции создания СКД из демонстрационной карточки доверенностей.
- PowersOfAttorneyWebExtension – папка с клиентским расширением, в котором реализованы обработчики жизненного цикла ПКД.
- PowersOfAttorneySolution.zip - архив с решением, включающим разметки тестовой карточки доверенности.
- PowersOfAttorneyCardsMetadata.zip - архив с данными карточек, добавляющие в систему Docsvision новые виды карточки Документ (Доверенность и Передоверие) и необходимые расширенные метаданные.


## Настройка среды разработки

**Перечень необходимых инструментов:** 
* [Visual Studio 2017/2019](https://www.visualstudio.com)
* [NodeJS v14.17.0+](https://nodejs.org/en/)

## Сборка проекта

1. Сборка серверной части.
   1. Откройте решение Samples.sln
   2. Соберите проект Other > PowersOfAttorney > PowersOfAttorneyServerExtension

2. Сборка клиентской части.
   1. Откройте в командной строке папку Others > PowersOfAttorney > PowersOfAttorneyWebExtension.

   2. Выполните команды:

      ```
      npm install
      npm update
      npm run build:prod
      ```

3. Публикация компонентов на сервере Web-клиент.

   1. Скопируйте папку `SamplesOutput\Site\Content\Modules\PowersOfAttorneyWebExtension\` в  `<Каталог установки Web-клиента>\Site\Content\Modules`.
   2. Скопируйте папку `SamplesOutput\Site\Extensions\PowersOfAttorneyServerExtension` в  `<Каталог установки Web-клиента>\Site\Extensions`.
   3. Перезапустите IIS.

## Проверка примера

1. Распакуйте PowersOfAttorneyCardsMetadata.zip и импортируйте карточки в систему Docsvision.

2. Распакуйте PowersOfAttorneySolution.zip и в Конструкторе web-разметок импортируйте решение Solution.xml.

3. В Web-клиенте создайте карточку документ вида Доверенность. Заполните обязательные поля. Если заполнены не все обязательные поля, при сохранении будет выдано предупреждение.

4. Нажмите кнопку Создать СКД. В результате будет создана СКД, связанная с текущей карточкой документа.

5. Нажмите кнопку Подписать МЧД. Будет предложено выбрать сертификат подписи - выполнено подписание МЧД.

6. Нажмите кнопку Сохранить МЧД. На компьютер будет сохранён архив, содержащий файл МЧД в формате XML и его подпись.
